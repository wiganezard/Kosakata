<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Kuis Kosakata Bab 7 (Minna no Nihongo) ‚Äî Per Kategori</title>
<style>
  :root{
    --bg:#0c1424;--panel:#121c2f;--text:#e8eefc;--muted:#93a4c8;
    --accent:#3b82f6;--accent-2:#60a5fa;--ok:#22c55e;--bad:#ef4444;
    --warn:#f59e0b;--border:#223153;
  }
  *{box-sizing:border-box}
  body{font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
       background:var(--bg);color:var(--text);margin:0;padding:24px}
  .container{max-width:760px;margin:auto;background:linear-gradient(180deg,#0f172a 0%,var(--panel)100%);
             border:1px solid var(--border);border-radius:16px;padding:24px;box-shadow:0 10px 30px rgba(0,0,0,.35)}
  h2{margin:0 0 10px;font-weight:800}
  button{padding:12px 18px;margin:10px 0;border:none;border-radius:10px;
         background:var(--accent);color:#fff;font-weight:700;cursor:pointer;transition:.2s}
  button:hover{filter:brightness(1.07)}button:disabled{opacity:.5;cursor:not-allowed}
  .option{display:block;margin:12px 0;padding:14px;border:1px solid var(--border);
          border-radius:10px;text-align:left;cursor:pointer;background:#0b1527;transition:.15s}
  .option:hover{background:#0f1c35}
  .option.correct{background:#0e1f17;border-color:var(--ok)}
  .option.wrong{background:#2a1111;border-color:var(--bad)}
  .progress{height:10px;background:#0a1222;border-radius:999px;overflow:hidden;margin:18px 0;border:1px solid var(--border)}
  .bar{height:100%;width:0;background:linear-gradient(90deg,var(--accent),var(--accent-2));transition:.3s}
  .meta{display:flex;justify-content:space-between;align-items:center;color:var(--muted);font-weight:600}
  .timer{font-weight:800;color:#fca5a5}
  .explain{margin-top:12px;padding:12px;border-left:4px solid var(--accent);
           background:#0a1222;border:1px solid var(--border);border-radius:10px}
  .review{margin-top:26px;text-align:left;background:#0a1222;border:1px solid var(--border);
          border-radius:12px;padding:18px}
  .review h3{color:var(--accent);margin:0 0 12px}
  .review-item{margin:10px 0 16px;border-bottom:1px dashed var(--border);padding-bottom:12px}
  .review-item.correct{border-left:4px solid var(--ok);padding-left:10px}
  .review-item.wrong{border-left:4px solid var(--bad);padding-left:10px}
  .review-item.timeout{border-left:4px solid var(--warn);padding-left:10px}
  #restart{display:none}
  select{padding:10px;border-radius:8px;border:1px solid var(--border);background:#0b1527;color:var(--text);font-weight:600}
</style>
</head>
<body>
<div class="container">
  <h2>Kuis Kosakata Bab 7</h2>
  
  <div id="categorySelectBox">
    <p><b>Pilih kategori soal:</b></p>
    <select id="categorySelect">
      <option value="all">Semua kategori</option>
      <option value="kata kerja">Kata kerja</option>
      <option value="benda">Benda</option>
      <option value="orang">Orang</option>
      <option value="ekspresi">Ekspresi & ungkapan</option>
    </select><br>
    <button id="startBtn">Mulai Kuis</button>
  </div>

  <div id="quizBox" style="display:none">
    <div class="progress"><div id="bar" class="bar"></div></div>
    <div class="meta"><div id="progressText">Soal 1/20</div><div class="timer"><span id="time">20</span></div></div>
    <h3 id="question" style="margin:14px 0 6px">Pertanyaan</h3>
    <div id="options"></div>
    <p id="result" style="font-weight:800"></p>
    <div id="explain" class="explain" style="display:none"></div>
    <button id="next" disabled>Berikutnya</button>
    <p id="scoreBox" style="color:var(--muted);font-weight:700">Skor: 0</p>
    <div id="reviewSection" class="review" style="display:none"></div>
    <button id="restart">üîÅ Ulangi Kuis</button>
  </div>
</div>

<script>
const allWords = [
  // ===== KATA KERJA =====
  {jp:"„Åü„Åπ„Åæ„Åô",id:"makan",cat:"kata kerja",e:"Kanji: È£ü„Åπ„Åæ„Åô = È£ü (ta, makan). = makan."},
  {jp:"„ÅÆ„Åø„Åæ„Åô",id:"minum",cat:"kata kerja",e:"Kanji: È£≤„Åø„Åæ„Åô = È£≤ (no, minum). = minum."},
  {jp:"„Åô„ÅÑ„Åæ„Åô",id:"mengisap (rokok)",cat:"kata kerja",e:"Kanji: Âê∏„ÅÑ„Åæ„Åô = Âê∏ (sui, isap). = mengisap [rokok]."},
  {jp:"„Åø„Åæ„Åô",id:"melihat, menonton",cat:"kata kerja",e:"Kanji: Ë¶ã„Åæ„Åô = Ë¶ã (mi, lihat). = melihat, menonton."},
  {jp:"„Åç„Åç„Åæ„Åô",id:"mendengar",cat:"kata kerja",e:"Kanji: ËÅû„Åç„Åæ„Åô = ËÅû (kiki, dengar). = mendengar."},
  {jp:"„Çà„Åø„Åæ„Åô",id:"membaca",cat:"kata kerja",e:"Kanji: Ë™≠„Åø„Åæ„Åô = Ë™≠ (yomi, baca). = membaca."},
  {jp:"„Åã„Åç„Åæ„Åô",id:"menulis, menggambar",cat:"kata kerja",e:"Kanji: Êõ∏„Åç„Åæ„Åô = Êõ∏ (kaki, tulis). = menulis, menggambar."},
  {jp:"„Åã„ÅÑ„Åæ„Åô",id:"membeli",cat:"kata kerja",e:"Kanji: Ë≤∑„ÅÑ„Åæ„Åô = Ë≤∑ (kai, beli). = membeli."},
  {jp:"„Å®„Çä„Åæ„Åô",id:"mengambil (foto)",cat:"kata kerja",e:"Kanji: ÊíÆ„Çä„Åæ„Åô = ÊíÆ (tori, ambil foto). = mengambil foto."},
  {jp:"„Åó„Åæ„Åô",id:"melakukan, mengerjakan",cat:"kata kerja",e:"Kata kerja serbaguna = melakukan / mengerjakan."},
  {jp:"„ÅÇ„ÅÑ„Åæ„Åô",id:"bertemu (dengan teman)",cat:"kata kerja",e:"Kanji: ‰ºö„ÅÑ„Åæ„Åô = ‰ºö (ai, bertemu). = bertemu (dengan teman)."},

  // ===== MAKANAN & MINUMAN =====
  {jp:"„Åî„ÅØ„Çì",id:"nasi",cat:"benda",e:"Kanji: „ÅîÈ£Ø = nasi; juga bisa berarti makan."},
  {jp:"„ÅÇ„Åï„Åî„ÅØ„Çì",id:"sarapan",cat:"benda",e:"Kanji: Êúù„ÅîÈ£Ø = makan pagi (sarapan)."},
  {jp:"„Å≤„Çã„Åî„ÅØ„Çì",id:"makan siang",cat:"benda",e:"Kanji: Êòº„ÅîÈ£Ø = makan siang."},
  {jp:"„Å∞„Çì„Åî„ÅØ„Çì",id:"makan malam",cat:"benda",e:"Kanji: Êô©„ÅîÈ£Ø = makan malam."},
  {jp:"„Éë„É≥",id:"roti",cat:"benda",e:"Serapan dari bahasa Portugis 'p√£o' = roti."},
  {jp:"„Åü„Åæ„Åî",id:"telur",cat:"benda",e:"Kanji: Âçµ = telur."},
  {jp:"„Å´„Åè",id:"daging",cat:"benda",e:"Kanji: ËÇâ = daging."},
  {jp:"„Åï„Åã„Å™",id:"ikan",cat:"benda",e:"Kanji: È≠ö = ikan."},
  {jp:"„ÇÑ„Åï„ÅÑ",id:"sayur",cat:"benda",e:"Kanji: ÈáéËèú = sayur-sayuran."},
  {jp:"„Åè„Å†„ÇÇ„ÅÆ",id:"buah-buahan",cat:"benda",e:"Kanji: ÊûúÁâ© = buah-buahan."},

  {jp:"„Åø„Åö",id:"air",cat:"benda",e:"Kanji: Ê∞¥ = air."},
  {jp:"„Åä„Å°„ÇÉ",id:"teh jepang (hijau)",cat:"benda",e:"Kanji: „ÅäËå∂ = teh hijau Jepang."},
  {jp:"„Åì„ÅÜ„Å°„ÇÉ",id:"teh hitam",cat:"benda",e:"Kanji: Á¥ÖËå∂ = teh hitam (barat)."},
  {jp:"„Åé„ÇÖ„ÅÜ„Å´„ÇÖ„ÅÜÔºà„Éü„É´„ÇØÔºâ",id:"susu",cat:"benda",e:"Kanji: Áâõ‰π≥ = susu sapi."},
  {jp:"„Ç∏„É•„Éº„Çπ",id:"jus",cat:"benda",e:"Kata serapan dari 'juice'."},
  {jp:"„Éì„Éº„É´",id:"bir",cat:"benda",e:"Kata serapan dari 'beer'."},
  {jp:"„Åï„Åë",id:"minuman keras (sake)",cat:"benda",e:"Kanji: ÈÖí = sake (minuman beras Jepang)."},
  {jp:"„Åü„Å∞„Åì",id:"rokok",cat:"benda",e:"Kanji: ÁÖôËçâ = tembakau, rokok."},

  // ===== BENDA / KEGIATAN =====
  {jp:"„Å¶„Åå„Åø",id:"surat",cat:"benda",e:"Kanji: ÊâãÁ¥ô = surat tulisan tangan."},
  {jp:"„É¨„Éù„Éº„Éà",id:"laporan",cat:"benda",e:"Kata serapan dari 'report'."},
  {jp:"„Åó„ÇÉ„Åó„Çì",id:"foto",cat:"benda",e:"Kanji: ÂÜôÁúü = foto."},
  {jp:"„Éì„Éá„Ç™",id:"video",cat:"benda",e:"Serapan dari 'video'."},
  {jp:"„Åø„Åõ",id:"toko",cat:"benda",e:"Kanji: Â∫ó = toko, tempat berjualan."},
  {jp:"„Å´„Çè",id:"halaman",cat:"benda",e:"Kanji: Â∫≠ = halaman rumah."},
  {jp:"„Åó„ÇÖ„Åè„Å†„ÅÑ",id:"pekerjaan rumah (PR)",cat:"benda",e:"Kanji: ÂÆøÈ°å = PR, tugas rumah dari sekolah."},
  {jp:"„ÉÜ„Éã„Çπ",id:"tenis",cat:"benda",e:"Serapan dari 'tennis'."},
  {jp:"„Çµ„ÉÉ„Ç´„Éº",id:"sepak bola",cat:"benda",e:"Serapan dari 'soccer'."},
  {jp:"„Åä„ÅØ„Å™„Åø",id:"melihat bunga sakura",cat:"benda",e:"Kanji: „ÅäËä±Ë¶ã = „Åä (kehormatan) + Ëä± (bunga) + Ë¶ã (melihat). = tradisi melihat sakura."},

  // ===== KATA KETERANGAN / UNGKAPAN =====
  {jp:"„Å™„Å´",id:"apa",cat:"ekspresi",e:"Kanji: ‰Ωï = apa."},
  {jp:"„ÅÑ„Å£„Åó„Çá„Å´",id:"bersama-sama",cat:"ekspresi",e:"Kanji: ‰∏ÄÁ∑í„Å´ = bersama-sama."},
  {jp:"„Å°„Çá„Å£„Å®",id:"sebentar, sedikit",cat:"ekspresi",e:"Dipakai untuk menyatakan sedikit waktu / jumlah."},
  {jp:"„ÅÑ„Å§„ÇÇ",id:"selalu",cat:"ekspresi",e:"Kata keterangan waktu = selalu."},
  {jp:"„Å®„Åç„Å©„Åç",id:"kadang-kadang",cat:"ekspresi",e:"Keterangan frekuensi = kadang-kadang."},
  {jp:"„Åù„Çå„Åã„Çâ",id:"setelah itu",cat:"ekspresi",e:"Ungkapan penghubung: 'lalu / setelah itu'."},
  {jp:"„Åà„Åà",id:"ya",cat:"ekspresi",e:"Ungkapan informal untuk 'ya'."},
  {jp:"„ÅÑ„ÅÑ„Åß„Åô„Å≠",id:"bagus ya, baik ya",cat:"ekspresi",e:"Ungkapan pujian / persetujuan: 'bagus ya'."},
  {jp:"„Çè„Åã„Çä„Åæ„Åó„Åü",id:"mengerti, baik",cat:"ekspresi",e:"Kanji: ÂàÜ„Åã„Çä„Åæ„Åó„Åü = saya mengerti."},
  {jp:"„Å™„Çì„Åß„Åô„Åã",id:"apa itu?",cat:"ekspresi",e:"Ungkapan bertanya: 'apa itu?'"}, 
  {jp:"„Åò„ÇÉ„ÄÅ„Åæ„Åü[„ÅÇ„Åó„Åü]",id:"sampai jumpa [besok]",cat:"ekspresi",e:"Ungkapan perpisahan santai: 'ya, sampai jumpa (besok)'."},

  // ===== NAMA TEMPAT =====
  {jp:"„É°„Ç≠„Ç∑„Ç≥",id:"Meksiko",cat:"benda",e:"Nama negara: Meksiko („É°„Ç≠„Ç∑„Ç≥)."},
  {jp:"„Åä„Åä„Åï„Åã„Éá„Éë„Éº„Éà",id:"toserba Osaka (fiktif)",cat:"benda",e:"Nama toko fiktif di buku."},
  {jp:"„Å§„ÇÑ„Åæ",id:"restoran fiktif",cat:"benda",e:"Nama tempat fiktif di latihan Bab 6."},
  {jp:"„Éï„É©„É≥„Çπ„ÇÑ",id:"pasar swalayan fiktif",cat:"benda",e:"Nama toko fiktif („Éï„É©„É≥„Çπ„ÇÑ)."},
  {jp:"„Åæ„ÅÑ„Å´„Å°„ÇÑ",id:"pasar swalayan fiktif",cat:"benda",e:"Nama toko fiktif („Åæ„ÅÑ„Å´„Å°„ÇÑ)."}
];

function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}return a;}

function buildQuestions(source){
  const qs=[];
  source.forEach(w=>{
    const wrongs=[];
    while(wrongs.length<3){
      const r=source[Math.floor(Math.random()*source.length)].id;
      if(r!==w.id && !wrongs.includes(r)) wrongs.push(r);
    }
    const opts=[w.id,...wrongs];
    shuffle(opts);
    qs.push({q:w.jp,a:opts,c:opts.indexOf(w.id),e:w.e});
  });
  return qs;
}

/* ===== logika utama kuis (identik Bab 6 + kategori) ===== */
function playSound(f,d){try{const c=new(window.AudioContext||window.webkitAudioContext)(),o=c.createOscillator(),g=c.createGain();
o.connect(g);g.connect(c.destination);o.type="sine";o.frequency.value=f;g.gain.setValueAtTime(0.22,c.currentTime);
o.start();o.stop(c.currentTime+d/1000);o.onended=()=>c.close()}catch(e){}}
const ding=()=>playSound(900,160),buzz=()=>playSound(180,320);
function shuffleQ(a){return a.sort(()=>Math.random()-.5);}
function withShuffledOptions(q){const p=q.a.map((t,i)=>({t,ok:i===q.c}));shuffle(p);q.a=p.map(x=>x.t);q.c=p.findIndex(x=>x.ok);return q;}

let quiz,index,score,startTime,remaining,timerId,answered=false;
const PER_SOAL=20;
const qEl=document.getElementById("question"),oEl=document.getElementById("options"),
res=document.getElementById("result"),exp=document.getElementById("explain"),
btn=document.getElementById("next"),bar=document.getElementById("bar"),
scoreBox=document.getElementById("scoreBox"),timeEl=document.getElementById("time"),
prog=document.getElementById("progressText"),review=document.getElementById("reviewSection"),
restart=document.getElementById("restart"),quizBox=document.getElementById("quizBox"),
catBox=document.getElementById("categorySelectBox");
let reviewData=[];

document.getElementById("startBtn").onclick=()=>{
  const cat=document.getElementById("categorySelect").value;
  catBox.style.display="none";quizBox.style.display="block";
  startQuiz(cat);
};

function startQuiz(cat){
  let selected=allWords;
  if(cat!=="all") selected=allWords.filter(w=>w.cat===cat);
  const built=buildQuestions(selected);
  quiz=shuffleQ(built).slice(0,20).map(withShuffledOptions);
  index=0;score=0;reviewData=[];
  btn.style.display="inline-block";btn.disabled=true;
  restart.style.display="none";review.style.display="none";
  bar.style.width="0%";load();
}

function startTimer(){
  clearInterval(timerId);remaining=PER_SOAL;
  timeEl.textContent=`${remaining}`;
  timerId=setInterval(()=>{
    remaining--;timeEl.textContent=`${remaining}`;
    if(remaining<=0){clearInterval(timerId);timesUp();}
  },1000);
}

function load(){
  const q=quiz[index];answered=false;
  qEl.textContent=`${index+1}. ${q.q}`;oEl.innerHTML="";
  q.a.forEach((opt,i)=>{
    const d=document.createElement("div");
    d.className="option";d.textContent=opt;
    d.onclick=()=>select(i,d);oEl.appendChild(d);
  });
  res.textContent="";exp.style.display="none";btn.disabled=true;
  bar.style.width=((index)/quiz.length*100)+"%";
  scoreBox.textContent=`Skor: ${score}`;prog.textContent=`Soal ${index+1}/${quiz.length}`;
  startTime=new Date();startTimer();
}

function select(i,el){
  if(answered)return;answered=true;clearInterval(timerId);
  const q=quiz[index];const opts=document.querySelectorAll(".option");opts.forEach(o=>o.onclick=null);
  let status="";
  if(i===q.c){el.classList.add("correct");res.textContent="‚úÖ Benar!";score++;ding();status="correct";}
  else{el.classList.add("wrong");opts[q.c].classList.add("correct");res.textContent="‚ùå Salah!";buzz();status="wrong";}
  exp.innerHTML=q.e;exp.style.display="block";btn.disabled=false;
  const now=new Date();const sisa=Math.max(0,PER_SOAL-Math.floor((now-startTime)/1000));
  reviewData.push({num:index+1,question:q.q,your:q.a[i],correct:q.a[q.c],status,explain:q.e,time:`sisa ${sisa}s`});
}

function timesUp(){
  if(answered)return;answered=true;const q=quiz[index];
  document.querySelectorAll(".option").forEach(o=>o.onclick=null);
  const opts=document.querySelectorAll(".option");if(opts[q.c])opts[q.c].classList.add("correct");
  res.textContent="‚è∞ Waktu habis!";buzz();
  exp.innerHTML=q.e;exp.style.display="block";btn.disabled=false;
  reviewData.push({num:index+1,question:q.q,your:"(waktu habis)",correct:q.a[q.c],status:"timeout",explain:q.e,time:"sisa 0s"});
}

btn.onclick=()=>{index++;if(index<quiz.length){load();}else{finish();}};
function finish(){
  clearInterval(timerId);
  qEl.textContent="üéâ Kuis selesai!";oEl.innerHTML="";
  res.textContent=`Skor akhir: ${score}/${quiz.length}`;
  const nilai=Math.round((score/quiz.length)*100);
  scoreBox.textContent=`Nilai: ${nilai} / 100`;
  exp.style.display="none";btn.style.display="none";bar.style.width="100%";
  showReview();restart.style.display="inline-block";
}

function showReview(){
  review.style.display="block";
  review.innerHTML="<h3>üìã Review Jawaban</h3>";
  reviewData.forEach(it=>{
    const d=document.createElement("div");
    d.className="review-item "+it.status;
    d.innerHTML=`<b>${it.num}. ${it.question}</b><br>${
      it.status==="correct"?"‚úÖ":it.status==="timeout"?"‚è∞":"‚ùå"
    } Jawaban kamu: ${it.your}<br>‚úÖ Jawaban benar: ${it.correct}<br>üïí ${it.time}<br>üí¨ ${it.explain}`;
    review.appendChild(d);
  });
}
restart.onclick=()=>{btn.style.display="inline-block";quizBox.style.display="none";catBox.style.display="block";};
</script>
</body>
</html>